# Angular Document Viewer with annotations

Приложение для просмотра документов и добавления аннотаций, реализованное на Angular 19.

## Описание функциональности

- Просмотр многостраничных документов с прокруткой
- Масштабирование документа (zoom in/out/reset)
- Добавление текстовых и графических аннотаций
- Перемещение аннотаций перетаскиванием
- Удаление аннотаций
- Сохранение документа с аннотациями

## Архитектура приложения

### Компоненты
- **DocumentViewerComponent** - главный компонент для отображения документа
- **PageViewerComponent** - компонент для отображения отдельной страницы
- **AnnotationComponent** - компонент аннотации с возможностью перетаскивания
- **AnnotationModalComponent** - модальное окно для создания аннотаций

### Модели данных
- **Document** - модель документа с массивом страниц
- **Annotation** - модель аннотации (текст/изображение)
- **DocumentPage** - модель страницы документа

### Сервисы
- **DocumentService** - сервис для работы с документами и аннотациями

### Плюсы реализации

1. **Современный Angular 19**
   - Использование standalone компонентов
   - Signals для реактивного состояния
   - OnPush стратегия детекции изменений
   - Современный синтаксис с control flow (@if, @for)

2. **Хорошая архитектура**
   - Разделение ответственности между компонентами
   - Использование сервисов для бизнес-логики
   - Четкое разделение моделей данных
   - Dependency injection через inject() функцию
   - Использование Angular CDK для модального окна
   - Кастомная Design System с частично адаптивной версткой
   - Использование БЭМ методологии для стилей

3. **Качественная реализация drag & drop**
   - Использование RxJS для обработки событий мыши
   - Оптимизация производительности через runOutsideAngular
   - Учет масштабирования при перетаскивании
   - Использование requestAnimationFrame для плавности

4. **Обработка ошибок**
   - Try-catch блоки в сервисах
   - Логирование ошибок в консоль
   - Graceful fallback для изображений

5. **Доступность (Accessibility)**
   - ARIA атрибуты для кнопок
   - Семантическая разметка
   - Подписи для элементов управления

6. **Типизация**
   - Строгая типизация TypeScript
   - Интерфейсы для всех моделей данных
   - Типизированные формы

### Минусы и проблемы

1. **Отсутствие обработки ошибок на UI уровне, нет уведомлений пользователю**
2. **Вероятные проблемы с производительностью при большом количестве аннотаций**
3. **Проблемы с большими изображениями, нет ограничения на размер загружаемых файлов**
4. **Ограниченная валидация, нет ограничений на размер аннотаций и отсутствует проверка выхода аннотаций за границы страницы**
5. **UX проблемы, нет подтверждения удаления аннотаций**
6. **Технические улучшения: добавить unit тесты, добавить линтер**

## Способы решения проблем

### 1. Улучшение обработки ошибок

```typescript
// Добавить глобальный error handler
@Injectable()
export class ErrorHandlingService {
  showError(message: string, type: 'error' | 'warning' = 'error') {
    // Показать toast уведомление
  }
}
```

### 2. Оптимизация производительности

```typescript
// 1. Добавить виртуальный скроллинг для страниц - Angular CDK Virtual Scrolling
// 2. Виртуализация аннотаций внутри страницы (показывать только те аннотации, что в области просмотра)
// 3. Возможно ленивая загрузка аннотаций при скролле
```

### 3. Проблемы с большими изображениями

```typescript
// Добавить валидацию размера и типа файлов
@Injectable()
export class FileValidationService {
  validateImageFile(file: File): { isValid: boolean; error?: string } {
    // Проверка размера (максимум 5MB)
    // Проверка типа (JPG, PNG, GIF, WebP)
    // Возврат результата валидации
  }
}
```

### 4. Добавление валидации аннотаций

```typescript
// Валидация координат
validatePosition(x: number, y: number, pageWidth: number, pageHeight: number): boolean {
  return x >= 0 && y >= 0 && x <= pageWidth && y <= pageHeight;
}
```

### 5. Улучшение UX

```typescript
// Добавить подтверждение удаления через CDK Dialog
async onDelete(): Promise<void> {
  const confirmed = await this.dialog.open(ConfirmDialogComponent, {
    data: { title: 'Удалить аннотацию?', message: 'Это действие нельзя отменить' }
  }).closed.toPromise();

  if (confirmed) {
    this.delete.emit(this.annotation.id);
  }
}
```

### 6. Технические улучшения

```typescript
// Покрыть юнит тестами
```

```bash
npm install -D eslint @typescript-eslint/eslint-plugin
```

## Запуск приложения

```bash
# Установка зависимостей
npm install

# Запуск в режиме разработки
npm start

# Сборка для продакшена
npm run build

# Запуск тестов
npm test
```
